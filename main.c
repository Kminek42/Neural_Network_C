#include "neural_network.h"
#include <stdio.h>
#include <time.h>

int main() {
    // Initialize the neural network -------------------------------------------
    // Define all weights and biases
    float data[170] = {
        0.44983466,  0.92056445, -0.61509243, -1.4112124 ,  1.02143472,
        0.99747388,  1.21192063,  0.34226453, -1.19710729, -0.00993943,
       -0.07690885,  0.43281705,  0.07310657, -0.20294992,  0.41517974,
       -0.28985682,  0.21135129, -1.23582042,  1.17433804,  0.4620604 ,
       -0.7502595 ,  0.56730396, -0.2855182 , -3.21863596,  0.70542186,
       -1.06040339, -1.68201071, -0.12798234, -0.08952539, -2.23205169,
       -1.44128046,  0.22150216,  2.41239248, -0.64490545, -0.91762794,
        0.2238918 ,  0.62473941,  1.19263215,  0.02571871, -1.59235768,
       -1.34815941,  0.81999282, -0.34053739, -1.41340436, -0.56148364,
       -0.84148926,  0.04918584, -1.42057988,  0.60134298, -0.60231773,
       -1.79129835,  0.14939385, -0.12761246, -1.29592814, -0.96508482,
        1.71657747, -1.28588977,  0.40618213, -1.67110937, -0.9649843 ,
        0.52495132, -0.43250065, -0.23331203,  2.25274682, -0.58758368,
       -0.08420524, -0.27941549, -0.26694981,  0.755961  , -0.5741374 ,
       -0.90827284, -0.74891419,  0.34026636,  0.21993052,  0.96832467,
       -1.64976127, -0.07945084, -0.47446604, -0.99728306, -1.20450546,
        0.31124764, -1.50633105, -0.2517484 ,  0.24602229, -0.87636154,
        0.8861286 , -1.87165185, -0.31752388,  0.65622722, -0.114749  ,
        0.63178663,  0.43170472, -0.96880023,  1.34927212,  0.11302052,
       -0.63635596, -1.5224128 ,  0.32796489, -0.58178847, -0.36146057,
        1.55705878,  0.28146996,  0.37890453, -0.15290519,  1.10781603,
        0.86473627, -2.31355886, -0.85477765, -0.32028899, -0.2744073 ,
       -0.58897703,  0.22932986, -1.51510418,  0.16999805,  1.19906164,
       -0.04021507, -0.3186802 , -0.26340764,  0.67657171, -0.54923976,
       -2.50119155,  1.55467606,  0.81137919, -1.26068414, -1.10008841,
       -0.23846895,  0.60400616,  0.79870806,  1.67330316, -0.33940412,
       -1.66312492,  0.68405767, -0.55653364,  0.07816264,  1.84547439,
        1.22970346, -0.38529189,  1.48985146, -0.15450453, -0.13837422,
       -0.36720982, -2.98515562, -0.07305605, -0.39694785, -0.72516405,
       -1.44674726, -1.40064772, -1.0990208 , -0.29270608, -0.40195668,
       -0.54199316,  0.55713056,  0.97356208, -0.39204265,  1.26353467,
        0.15171902,  0.32572507, -1.39998996,  0.60089793, -0.89023041,
       -1.3044907 , -0.42618643, -1.59614907,  0.66458321, -0.90677026,
        0.87008614,  1.27057392, -0.80229837,  0.67611137, -0.21835998
    };
    
    // Define the shape of the neural network
    int32_t shape[4] = {10, 8, 6, 4};

    // Create the neural network
    neuralNetwork nn = nn_make(shape, 4);  //layer_n = len(shape)

    // Fill weights and biases with data
    nn_fill(nn, data);

    // Define output array with lenght = max(shape)
    // [It is also used to store temporary data in neural network]
    float output[10];


    // Use the neural network --------------------------------------------------
    // Define input array
    float inputs[10] = {
        1.13100498,  0.39506118,  0.03086807, -0.1540792 , -0.62408602,
        0.83034898,  0.60624576,  0.1255526 ,  1.86405194,  1.04523842
    };

    nn_forward(nn, inputs, output);


    return 0;
}
